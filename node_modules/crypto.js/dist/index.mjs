import d from"os";import o from"fs";import u from"crypto";var h=["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-ccm","aes-192-ccm","aes-256-ccm","aes-128-ocb","aes-192-ocb","aes-256-ocb"],y=+process.versions.node.split(".").slice(0,2).join("."),p=u.scryptSync?u.scryptSync("","",16):Buffer.from("0xd7 0x2c 0x87 0xd0 0xf0 0x77 0xc7 0x76 0x6f 0x29 0x85 0xdf 0xab 0x30 0xe8 0x95".split(" "));u.randomUUID||(u.randomUUID=function(){let e=u.randomBytes(16).toString("hex");return e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(-12)});u.randomInt||(u.randomInt=function(e){if(e===void 0)throw new TypeError('[ERR_INVALID_ARG_TYPE]: The "max" argument must be a safe integer. Received undefined');return~~(Math.random()*e)});var m=u,l=function(e,r,t){let i=u.createHash(e),f=Buffer.isBuffer(r);return i.update(r,f?"binary":"utf8"),i.digest(t||"hex")},S=function(e,r,t,i){t=t||"";let f=u.createHmac(e,t),n=Buffer.isBuffer(r);return f.update(r,n?"binary":"utf8"),f.digest(i||"hex")},v=function(e,r,t=p,i,f){if(y>=10.5)return B(e,r,t,p,i,f);i=Buffer.isBuffer(r)?"binary":i||"utf8",f=f||"base64";let s=u.createCipher(e,t),a=s.update(r,i,f);if(a+=s.final(f),h.indexOf(e)>-1){let c=s.getAuthTag();return{enStr:a,authTag:c}}return a},_=function(e,r,t=p,i,f,n){if(y>=10.5)return b(e,r,t,p,i,f,n);f=Buffer.isBuffer(r)?"binary":f||"base64",n=n||"utf8";let a=u.createDecipher(e,t);h.indexOf(e)>-1&&a.setAuthTag(i);let c=a.update(r,f,n);return c+=a.final(n),c},B=function(e,r,t=p,i=p,f,n){f=Buffer.isBuffer(r)?"binary":f||"utf8",n=n||"base64";let a=u.createCipheriv(e,t,i),c=a.update(r,f,n);if(c+=a.final(n),h.indexOf(e)>-1){let x=a.getAuthTag();return{enStr:c,authTag:x}}return c},b=function(e,r,t=p,i=p,f,n,s){n=Buffer.isBuffer(r)?"binary":n||"base64",s=s||"utf8";let c=u.createDecipheriv(e,t,i);h.indexOf(e)>-1&&c.setAuthTag(f);let x=c.update(r,n,s);return x+=c.final(s),x};var T=function(e){for(let r in e){if(r==="lo")continue;return e[r].pop().mac.replace(/:/g,"").slice(-4)}return Math.random().toString(16).slice(-4)}(d.networkInterfaces()),g=1;function I(e,r){var t,i;return Buffer.isBuffer(e)?t=e:t=Buffer.from(e+""),i=t.toString("base64"),r?i.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""):i}function A(e,r){return r&&(e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/[^A-Za-z0-9\+\/]/g,"")),Buffer.from(e,"base64")}function O(e,r){let t="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM0123456789";r&&(t="0123456789");let i=t.length,f="";for(let n=0;n<e;n++)f+=t[m.randomInt(i)];return f}function D(e="-"){var r=m.randomUUID(),t=(~~(Date.now()/1e3)).toString(16);return g++,g>65535&&(g=1),r+=g.toString(16),t+e+T+e+r.slice(0,4)+e+r.slice(-8)}function R(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?l("md5",e,r):e}function U(e){if(o.accessSync(e,o.constants.R_OK)){var r=o.readFileSync(e);return l("md5",r)}return null}function w(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?l("sha1",e,r):e}function M(e){if(o.accessSync(e,o.constants.R_OK)){var r=o.readFileSync(e);return l("sha1",r)}return null}function K(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?l("sha256",e,r):e}function C(e){if(o.accessSync(e,o.constants.R_OK)){var r=o.readFileSync(e);return l("sha256",r)}return null}var V={base64encode:I,base64decode:A,rand:O,uuid:D,md5:R,md5Sign:U,sha1:w,sha1Sign:M,sha256:K,sha256Sign:C,origin:m,hash:l,hmac:S,cipher:v,decipher:_,cipheriv:B,decipheriv:b};export{A as base64decode,I as base64encode,v as cipher,B as cipheriv,_ as decipher,b as decipheriv,V as default,l as hash,S as hmac,R as md5,U as md5Sign,m as origin,O as rand,w as sha1,M as sha1Sign,K as sha256,C as sha256Sign,D as uuid};
